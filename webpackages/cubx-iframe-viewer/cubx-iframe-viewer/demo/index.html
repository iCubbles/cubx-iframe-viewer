<!DOCTYPE html>
<html>

<head>
    <meta charset="UTF-8">
    <title>&lt;cubx-iframe-viewer&gt; demo</title>

    <script src="../../../cubx.core.rte@2.3.1/webcomponents-lite/webcomponents-lite.js"></script>
    <script>
        window.cubx = {
            "CRCInit": {
                "rootDependencies": [
                    {
                        "webpackageId": "bootstrap-3.3.5@1.1.1",
                        "artifactId": "bootstrap"
                    },
                    {
                        "webpackageId": "highlightjs-9.3.0@1.1.0",
                        "artifactId": "highlightjs-github-gist"
                    }
                ]
            }
        }
    </script>
    <script src="../../../cubx.core.rte@2.3.1/crc-loader/js/main.js" data-crcinit-loadcif="true"></script>

</head>
<body>
<div class="container">
    <div class="row">
        <h3 id="demo1">1) cubx-iframe-viewer with component artifactId and webpackageId</h3>
        <cubx-iframe-viewer cubx-webpackage-id="this">
            <cubx-core-init style="display:none">
                <cubx-core-slot-init slot="artifactInfo">{
                    "webpackageId": "cubx-generic-component-viewer@1.0.1",
                    "artifactId": "cubx-generic-component-viewer"
                    }</cubx-core-slot-init>
            </cubx-core-init>
        </cubx-iframe-viewer>
    </div>
    <div class="row">
        <h3 id="demo2">2) cubx-iframe-viewer with information from <a href="#demo1">1)</a> + inits</h3>
        <cubx-iframe-viewer cubx-webpackage-id="this">
            <cubx-core-init style="display:none">
                <cubx-core-slot-init slot="artifactInfo">{
                    "webpackageId": "cubx-generic-component-viewer@1.0.1",
                    "artifactId": "cubx-generic-component-viewer",
                    "inits":{"definitions":{"components":{"cubx-textarea":{"artifactId":"cubx-textarea","slots":[{"slotId":"value","direction":["output","input"]}],"webpackageId":"com.incowia.basic-html-components@1.4-SNAPSHOT"}},"members":[{"memberId":"textarea1","artifactId":"cubx-textarea"},{"memberId":"textarea2","artifactId":"cubx-textarea"}],"connections":[{"connectionId":"valueCon","copyValue":true,"destination":{"memberIdRef":"textarea2","slot":"value"},"source":{"memberIdRef":"textarea1","slot":"value"},"hookFunction":null,"repeatedValues":false}]}}
                    }</cubx-core-slot-init>
            </cubx-core-init>
        </cubx-iframe-viewer>
    </div>
    <div class="row">
        <h3 id="demo3">3) cubx-iframe-viewer with information from <a href="#demo2">2)</a> + dependencies</h3>
        <cubx-iframe-viewer id="demoDeps" cubx-webpackage-id="this">
            <cubx-core-init style="display:none">
                <cubx-core-slot-init slot="artifactInfo">{
                    "webpackageId": "cubx-generic-component-viewer@1.0.1",
                    "artifactId": "cubx-generic-component-viewer",
                    "inits":{"definitions":{"components":{"cubx-textarea":{"artifactId":"cubx-textarea","slots":[{"slotId":"value","direction":["output","input"]}],"webpackageId":"com.incowia.basic-html-components@1.4-SNAPSHOT"}},"members":[{"memberId":"textarea1","artifactId":"cubx-textarea"},{"memberId":"textarea2","artifactId":"cubx-textarea"}],"connections":[{"connectionId":"valueCon","copyValue":true,"destination":{"memberIdRef":"textarea2","slot":"value"},"source":{"memberIdRef":"textarea1","slot":"value"},"hookFunction":null,"repeatedValues":false}]}},
                    "dependencies":[{"webpackageId": "bootstrap-3.3.5@1.1.1","artifactId": "bootstrap-bootstrap-css-only"}]
                    }</cubx-core-slot-init>
            </cubx-core-init>
        </cubx-iframe-viewer>
    </div>
    <div class="row">
        <h3 id="demo4">4) cubx-iframe-viewer with information from <a href="#demo3">3)</a> + custom width and custom height</h3>
        <cubx-iframe-viewer cubx-webpackage-id="this">
            <cubx-core-init style="display:none">
                <cubx-core-slot-init slot="artifactInfo">{
                    "webpackageId": "cubx-generic-component-viewer@1.0.1",
                    "artifactId": "cubx-generic-component-viewer",
                    "inits":{"definitions":{"components":{"cubx-textarea":{"artifactId":"cubx-textarea","slots":[{"slotId":"value","direction":["output","input"]}],"webpackageId":"com.incowia.basic-html-components@1.4-SNAPSHOT"}},"members":[{"memberId":"textarea1","artifactId":"cubx-textarea"},{"memberId":"textarea2","artifactId":"cubx-textarea"}],"connections":[{"connectionId":"valueCon","copyValue":true,"destination":{"memberIdRef":"textarea2","slot":"value"},"source":{"memberIdRef":"textarea1","slot":"value"},"hookFunction":null,"repeatedValues":false}]}},
                    "dependencies":[{"webpackageId": "bootstrap-3.3.5@1.1.1","artifactId": "bootstrap-bootstrap-css-only"}]
                    }</cubx-core-slot-init>
                <cubx-core-slot-init slot="width">"80%"</cubx-core-slot-init>
                <cubx-core-slot-init slot="height">"300px"</cubx-core-slot-init>
            </cubx-core-init>
        </cubx-iframe-viewer>
    </div>
    <div class="row">
        <h3 id="demo5">5) cubx-iframe-viewer with information from <a href="#demo3">3)</a> + autoHeight</h3>
        <cubx-iframe-viewer cubx-webpackage-id="this">
            <cubx-core-init style="display:none">
                <cubx-core-slot-init slot="artifactInfo">{
                    "webpackageId": "cubx-generic-component-viewer@1.0.1",
                    "artifactId": "cubx-generic-component-viewer",
                    "inits":{"definitions":{"components":{"cubx-textarea":{"artifactId":"cubx-textarea","slots":[{"slotId":"value","direction":["output","input"]}],"webpackageId":"com.incowia.basic-html-components@1.4-SNAPSHOT"}},"members":[{"memberId":"textarea1","artifactId":"cubx-textarea"},{"memberId":"textarea2","artifactId":"cubx-textarea"}],"connections":[{"connectionId":"valueCon","copyValue":true,"destination":{"memberIdRef":"textarea2","slot":"value"},"source":{"memberIdRef":"textarea1","slot":"value"},"hookFunction":null,"repeatedValues":false}]},"viewerHeight":"180px","scale":"auto"},
                    "dependencies":[{"webpackageId": "bootstrap-3.3.5@1.1.1","artifactId": "bootstrap-bootstrap-css-only"}]
                    }</cubx-core-slot-init>
                <cubx-core-slot-init slot="autoHeight">true</cubx-core-slot-init>
            </cubx-core-init>
        </cubx-iframe-viewer>
    </div>
    <div class="row">
        <h3 id="demo6">6) cubx-iframe-viewer with information from <a href="#demo5">5)</a> + 'iframeCifReady' event + component slot changing</h3>
        <input disabled id="changeSlotNumber" type="number" min="50" value="60">
        <span> px </span>
        <input disabled class="btn btn-primary" id="changeSlotBtn" value="Change viewerHeight slot">
        <cubx-iframe-viewer cubx-webpackage-id="this">
            <cubx-core-init style="display:none">
                <cubx-core-slot-init slot="artifactInfo">{
                    "webpackageId": "cubx-generic-component-viewer@1.0.1",
                    "artifactId": "cubx-generic-component-viewer",
                    "inits":{"definitions":{"components":{"cubx-textarea":{"artifactId":"cubx-textarea","slots":[{"slotId":"value","direction":["output","input"]}],"webpackageId":"com.incowia.basic-html-components@1.4-SNAPSHOT"}},"members":[{"memberId":"textarea1","artifactId":"cubx-textarea"},{"memberId":"textarea2","artifactId":"cubx-textarea"}],"connections":[{"connectionId":"valueCon","copyValue":true,"destination":{"memberIdRef":"textarea2","slot":"value"},"source":{"memberIdRef":"textarea1","slot":"value"},"hookFunction":null,"repeatedValues":false}]},"viewerHeight":"180px","scale":"auto"},
                    "dependencies":[{"webpackageId": "bootstrap-3.3.5@1.1.1","artifactId": "bootstrap-bootstrap-css-only"}]
                    }</cubx-core-slot-init>
                <cubx-core-slot-init slot="autoHeight">true</cubx-core-slot-init>
            </cubx-core-init>
        </cubx-iframe-viewer>
    </div>
</div>

<script>
    (function(){
        'use strict';
        document.addEventListener('iframeCifReady', function (e) {
            var setVwrHeightBtn = document.querySelector('#changeSlotBtn');
            var setVwrHeightInput = document.querySelector('#changeSlotNumber');
            var divContainer = setVwrHeightBtn.parentNode;
            if (divContainer.querySelector('cubx-iframe-viewer').getAttribute('runtime-id') === e.detail.runtimeId) {
                setVwrHeightBtn.addEventListener('click', function () {
                    divContainer.querySelector('cubx-iframe-viewer').setSlotChange({
                        slot: 'viewerHeight',
                        value: setVwrHeightInput.value + 'px'
                    })
                });
                setVwrHeightBtn.removeAttribute('disabled');
                setVwrHeightInput.removeAttribute('disabled');
            }
        });
        document.addEventListener('cifReady', function () {
            document.querySelectorAll('cubx-iframe-viewer ').forEach(function (component, i) {
                var codeString = '<cubx-iframe-viewer cubx-webpackage-id="this">' +
                        component.querySelector('cubx-core-init').outerHTML +
                        '</cubx-iframe-viewer>';
                var codeBlock = generateCodeBlock(codeString , 'codeBlock'+ i);
                component.parentNode.appendChild(codeBlock);
                component.parentNode.appendChild(document.createElement('hr'));
            });
        });

        function generateCodeBlock(code, id) {
            var container = document.createElement('div');
            container.className = 'panel-group';
            container.innerHTML = '<div class="panel panel-default"> <div class="panel-heading"> <h4 class="panel-title"> <a data-toggle="collapse" data-parent="#accordion" href="#' + id + '">Code</a> </h4> </div> <div id="' + id + '" class="panel-collapse collapse"> <div class="panel-body"> <pre><code class="html"></code></pre> </div> </div> </div>';
            var textCode = document.createTextNode(code);
            var codeElement = container.querySelector('code');
            codeElement.appendChild(textCode);
            hljs.highlightBlock(codeElement);
            return container;
        }
    })();
</script>
</body>
</html>
